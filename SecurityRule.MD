
## filterChain ì—ì„œ HttpSecurity ë¥¼ ì„¤ì •í• ë•Œ,  

Spring Security 6ë¶€í„°ëŠ” ê¶Œí•œ ë¶€ì—¬ ê·œì¹™ì—ì„œ ìš”êµ¬í•˜ì§€ ì•ŠëŠ” í•œ(denyAll, permitAll) ì„¸ì…˜ì— pingì„ ë³´ë‚´ì§€ ì•ŠìŠµë‹ˆë‹¤. 
ì„¸ì…˜ì—ì„œ ì¸ì¦ì„ ê°€ì ¸ì˜¤ì§€ ì•ŠìŒìœ¼ë¡œì¨ ì„±ëŠ¥ ì˜í–¥ì´ í•´ê²°ë˜ì—ˆìœ¼ë¯€ë¡œ, ê°€ëŠ¥í•œ ëª¨ë“  ìš”ì²­ì— ê¶Œí•œì„ ì •ì˜í•´ ì£¼ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

ê¶Œí•œ ì„¤ì •ì€ ë‚˜ì—´ëœ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì²« ë²ˆì§¸ ì¼ì¹˜ í•­ëª©ì—ë§Œ ì ìš©í•©ë‹ˆë‹¤.

ìŠ¤í”„ë§ì€ ëª¨ë“  ë””ìŠ¤íŒ¨ì²˜ ìœ í˜•ì„ ê´€ë¦¬í•˜ë¯€ë¡œ ì‚¬ìš©ìì— ì˜í•œ ìš”ì²­ request ì™¸ì—ë„ ì‹œìŠ¤í…œ ì²˜ë¦¬ì— ì˜í•œ forwards, errors, includes ì— ëŒ€í•œ ê¶Œí•œë„ ì •ì˜í•´ì•¼í•œë‹¤.
ğŸ¥½DispatcherType : ë””ìŠ¤íŒ¨ì²˜ ìœ í˜•
* REQUEST : í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì˜¨ ìš”ì²­
* ERROR : ì—ëŸ¬ì— í•´ë‹¹í•˜ëŠ” ìš”ì²­
* FORWARD : ì„œë¸”ë¦¿ì—ì„œ ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSPë¥¼ í˜¸ì¶œí•  ë•Œ
* INCLUDE : ì„œë¸”ë¦¿ì—ì„œ ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSPì˜ ê²°ê³¼ë¥¼ í¬í•¨í•  ë•Œ
* ASYNC : ì„œë¸”ë¦¿ ë¹„ë™ê¸° í˜¸ì¶œ

ê¶Œí•œì„ ì •ì˜í•  ëŒ€ìƒì„ ì„ íƒí•œë‹¤.
* dispatcherTypeMatchers(DispatcherType...) : ë””ìŠ¤íŒ¨ì¹˜ ìœ í˜•ì— ë”°ë¼ ì •ì˜í•¨. ê°€ë³€ì¸ìë¥¼ ë°›ìŒ.
* requestMatchers(HttpMethod) : Http ìœ í˜•ì— ë”°ë¼ ê¶Œí•œì„ ë‹¤ë¥´ê²Œ ì •ì˜í•œë‹¤. ex. GET, POST ë“±.
* requestMatchers(HttpMethod) : Http ìœ í˜•ì— ë”°ë¼ ê¶Œí•œì„ ë‹¤ë¥´ê²Œ ì •ì˜í•œë‹¤. ex. GET, POST ë“±.
* requestMatchers(String...) : ì¼ì¹˜í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ê²½ë¡œì˜ ìš”ì²­ì— ëŒ€í•´ì„œ ì •ì˜í•¨. ê°€ë³€ì¸ìë‚˜ ì •ê·œí‘œí˜„ì‹ì„ í†µí•´ ë‹¤ì¤‘ ì •ì˜í•  ìˆ˜ë„ ìˆë‹¤. 
  * ("/path", "/api") : /path ê²½ë¡œì™€ /api ê²½ë¡œì— ëŒ€í•´ ê¶Œí•œì„ ì¼ê´„ ì„¤ì •í•¨.
  * ("/path/**") : /path í•˜ìœ„ì˜ ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ ê¶Œí•œì„ ì¼ê´„ ì„¤ì •í•¨.
  * ("/resource/[A-Za-z0-9]+") : /resource í•˜ìœ„ì˜ 1ê°œ ì´ìƒì˜ ì˜ë¬¸ê³¼ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ ê¶Œí•œì„ ì¼ê´„ ì„¤ì •í•¨.
* anyRequest() : ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ê²½ë¡œì˜ ìš”ì²­ì— ëŒ€í•´ì„œ ì •ì˜í•¨.

ê¶Œí•œ ë¶€ì—¬ ì˜µì…˜
* .denyAll() : ì¸ì¦í›„ ì–´ë– í•œ ìƒí™©ì—ì„œë„ ì ‘ê·¼ì„ ê±°ë¶€. ë¡œê·¸ì¸ í›„ 403 ì—ëŸ¬ ë°œìƒ. ë”ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í˜ì´ì§€ì— ì‚¬ìš©ë¨.
* .permitAll() : ì¸ì¦ë¶ˆí•„ìš”
* .authenticated() : ì¸ì¦í•„ìš”
* .hasRole(String) : ì§€ì •ëœ ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì¸ì¦ í›„ ì ‘ê·¼ê°€ëŠ¥
* .hasAnyRole(String...) : ì§€ì •ëœ í•˜ë‚˜ ì´ìƒì˜ ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì¸ì¦ í›„ ì ‘ê·¼ê°€ëŠ¥
* .hasAuthority(String) : ì§€ì •ëœ ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì¸ì¦ í›„ ì ‘ê·¼ê°€ëŠ¥
* .hasAnyAuthority(String...) : ì§€ì •ëœ í•˜ë‚˜ ì´ìƒì˜ ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì¸ì¦ í›„ ì ‘ê·¼ê°€ëŠ¥
* .access(AuthorizationManager) : ì‚¬ìš©ì ì •ì˜ì— ì˜í•´ ì ‘ê·¼ì—¬ë¶€ë¥¼ ê²°ì • ex. allOf(hasAuthority("db"), hasRole("ADMIN"))

ì—­í• ê³¼ ê¶Œí•œì€ ì ‘ë‘ì‚¬(prefix)ì˜ ì°¨ì´.
* Role : "USER", "ADMIN", "MANAGER" ... : ë°ì´í„°ë² ì´ìŠ¤ì— ì‚¬ìš©ì ê¶Œí•œ ì»¬ëŸ¼ì—ì„œ 'ROLE_USER' ë˜ëŠ” 'ROLE_ADMIN'ì´ ìˆëŠ”ì§€ ì¡°íšŒí•¨. 'ROLE_' ì´ í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.
* Authority : "READ_PRIVILEGES", "WRITE_PRIVILEGES", "DELETE_PRIVILEGES" ... : ì‚¬ìš©ì ê¶Œí•œì—ì„œ 'READ_PRIVILEGES' ë˜ëŠ” 'WRITE_PRIVILEGES'ì´ ìˆëŠ”ì§€ ì¡°íšŒí•¨


## ì„œë¸”ë¦¿ ê²½ë¡œê°€ ë‹¤ë¥¸ ê²½ìš°,

ë³´í†µì€ ì„œë¸”ë¦¿ ê²½ë¡œ(spring.mvc.servlet.path)ë¥¼ ê¸°ë³¸ê°’ì¸ ë£¨íŠ¸ê²½ë¡œ '/'ë¡œ ì§€ì •í•œë‹¤.
ê·¸ëŸ¬ë‚˜ ë‹¤ë¥´ê²Œ ì§€ì •í•œë‹¤ë©´ ì•„ë˜ì˜ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. ì„œë¸”ë¦¿ ê²½ë¡œì™€ ì»¨íŠ¸ë¡¤ëŸ¬ ê²½ë¡œë¥¼ ë¶„í•  í•´ ì •ì˜í•´ì£¼ì–´ì•¼ í•œë‹¤.

* MvcRequestMatcher.Builder(HandlerMappingIntrospector).servletPath(String);
* MvcRequestMatcher.Builder.pattern("/my/controller/**"))

```java

@Bean
MvcRequestMatcher.Builder mvc(HandlerMappingIntrospector introspector) {
	return new MvcRequestMatcher.Builder(introspector).servletPath("/spring-mvc");
}

@Bean
SecurityFilterChain appEndpoints(HttpSecurity http, MvcRequestMatcher.Builder mvc) {
    http
    .authorizeHttpRequests((authorize) -> authorize
    .requestMatchers(mvc.pattern("/my/controller/**")).hasAuthority("controller")
    .anyRequest().authenticated()
    );
    
    return http.build();
}
        
```

## ì²´ì´ë‹ ë°©ì‹ ì§€ì–‘

ë©”ì†Œë“œì˜ ì˜µì…˜ê°’ì„ ì²´ì´ë‹ ì‚¬ìš©í•¨ìœ¼ë¡œ í˜¼ì„ ì„ ì£¼ë˜ ê³¼ê±° ë°©ì‹ì„ ì§€ì–‘í•˜ê³ 
ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ì— ì˜µì…˜ê³¼ ê´€ë ¨í•œ ëŒë‹¤í•¨ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‚´ë¶€ ë©”ì†Œë“œê°€ ë³€ê²½ë¨. 
ê³¼ê±° ë°©ì‹ì€ IDE ì—ì„œ ë¬¸ë²•ìƒ ì˜¤ë¥˜ë¡œ ë³´ê³  ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚´.

ì˜ˆì œ csrf ë¹„í™œì„±í™”

```
http
    //.csrf().disable() // ê³¼ê±°ë°©ì‹
    .csrf( csrf -> csrf.disable()) // ë³€ê²½ëœ ë°©ì‹
```

```java
//ê´€ë ¨ì½”ë“œ
@Deprecated( since = "6.1", forRemoval = true )
public CsrfConfigurer<HttpSecurity> csrf() throws Exception {
        ApplicationContext context = this.getContext();
        return (CsrfConfigurer)this.getOrApply(new CsrfConfigurer(context));
        }

public HttpSecurity csrf(Customizer<CsrfConfigurer<HttpSecurity>> csrfCustomizer) throws Exception {
        ApplicationContext context = this.getContext();
        csrfCustomizer.customize((CsrfConfigurer)this.getOrApply(new CsrfConfigurer(context)));
        return this;
        }
```

## ë°ì´í„°ë² ì´ìŠ¤ h2 ë¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•œ ì„¤ì •

h2-consoleì€ frame íƒœê·¸ë¥¼ í†µí•´ êµ¬í˜„í•œë‹¤.
X-Frame-Optionsê°€ ê¸°ë³¸ê°’ DENYë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´, í•´ë‹¹ ë„ë©”ì¸ì˜ í˜ì´ì§€ëŠ” ì–´ë””ì—ì„œë„  <frame> í˜¹ì€ <iframe>íƒœê·¸ë¡œ ë¡œë“œë  ìˆ˜ê°€ ì—†ê²Œ ëœë‹¤.

ì•„ë˜ ê²½ë¡œë¡œ http ìš”ì²­ì„ ë³´ë‚¸ë‹¤.
`http://localhost:8080/h2-console/header.jsp?jsessionid=0340fe8bf5d09068c343660456ea676e`
